---
import '../../styles/global.css';
import type { NavigationMenuLink } from '../../data/navigation';
import NavigationSubMenuLink from './NavigationSubMenuLink.astro';

export interface Props {
 text: string;
 path?: string;
 subMenuLinks?: NavigationMenuLink[];
}

const { text, path, subMenuLinks } = Astro.props;

const hasSubMenuLinks = subMenuLinks && subMenuLinks.length > 0;

if (!path && !hasSubMenuLinks) {
  throw new Error(`Path or at least one navigation link is required for item '${text}'.`)
}

const menuItemTextStyle = "text-lg text-on-background ff-sans-condensed letter-spacing-sm";
---

<li class="navigation-menu-item color-background">
  <div class:list={[
    "menu-header",
    "center",
    hasSubMenuLinks ? "arrow-indicator" : "",
    ]}
  >
    {
      path ? 
      <a href={path}>
        <p class={menuItemTextStyle}>{ text }</p>
      </a> :
      <p class={menuItemTextStyle}>{ text }</p>
    }
  </div>
  
  { hasSubMenuLinks &&
    <ul class="navigation-sub-menu">
      {subMenuLinks.map(subMenuLink => <NavigationSubMenuLink {...subMenuLink} />)}
    </ul>
  }
</li>

<style>

  .navigation-menu-item {
    border: 1px solid hsl(var(--color-surface));
    border-width: 1px 0;
    transition: background-color ease-in 0.25s;
    flex: 1 1 0px;
    position: relative;
    width: 100%;
  }

  .navigation-menu-item:hover {
    background-color: hsl(var(--color-surface) / .75);
  }

  .navigation-menu-item:hover .navigation-sub-menu {
    display: block;
  }

  .menu-header:active {
    box-shadow: inset 0 0 1px 1px hsl(var(--color-on-surface) / .75);
  }

  .navigation-sub-menu {
    display: none;
    list-style: none;
    position: absolute;
    z-index: 1;
    top: calc(100% + 1px);
    transition: all 0.1s ease-in;
    padding: 0;
    min-width: 100%;
    border: solid hsl(var(--color-surface));
    border-width: 0px 1px 0 0;
    box-shadow: -1px 1px 1px 1px hsl(var(--color-surface));
  }

  .menu-header {
    position: relative;
    display: flex;
    width: 100%;
    height: 100%;
    padding: 0 2rem;
  }

  .arrow-indicator::after {
    content: "";
    position: absolute;
    display: inline-block;
    border: solid hsl(var(--color-primary));
    opacity: 0;
    border-width: 0 2px 2px 0;
    padding: 3px;
    top: 50%;
    right: 1.25rem;
    transform: translate(0, -50%);
    transition: all var(--transition-bezier);
  }

  .navigation-menu-item:hover .arrow-indicator::after {
    opacity: 1;
    transform: translate(0, -50%) rotate(45deg);
  }

  .navigation-menu-item .menu-header::before {
    content: "";
    position: absolute;
    left: 0;
    top: -1px;
    height: 2px;
    width: 0;
    background: hsl(var(--color-primary));
    transition: all var(--transition-bezier);
  }

  .navigation-menu-item:hover .menu-header::before {
    width: 100%
  }

  .menu-header p {
    position: relative;
    cursor: default;
    user-select: none;
  }

  .menu-header > a > p {
    cursor: pointer;
  }

  .menu-header > a::after {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
  }

</style>
